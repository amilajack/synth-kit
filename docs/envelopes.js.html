<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>envelopes.js - Postman Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#add">add</a></li><li><a href="global.html#adshr">adshr</a></li><li><a href="global.html#after">after</a></li><li><a href="global.html#bypass">bypass</a></li><li><a href="global.html#connect">connect</a></li><li><a href="global.html#constant">constant</a></li><li><a href="global.html#context">context</a></li><li><a href="global.html#contextOf">contextOf</a></li><li><a href="global.html#dest">dest</a></li><li><a href="global.html#detune">detune</a></li><li><a href="global.html#feedback">feedback</a></li><li><a href="global.html#fetch">fetch</a></li><li><a href="global.html#filter">filter</a></li><li><a href="global.html#gain">gain</a></li><li><a href="global.html#generate">generate</a></li><li><a href="global.html#inst">inst</a></li><li><a href="global.html#lifecycle">lifecycle</a></li><li><a href="global.html#load">load</a></li><li><a href="global.html#master">master</a></li><li><a href="global.html#mult">mult</a></li><li><a href="global.html#note">note</a></li><li><a href="global.html#now">now</a></li><li><a href="global.html#osc">osc</a></li><li><a href="global.html#oscBank">oscBank</a></li><li><a href="global.html#perc">perc</a></li><li><a href="global.html#plug">plug</a></li><li><a href="global.html#sample">sample</a></li><li><a href="global.html#samplingRate">samplingRate</a></li><li><a href="global.html#scale">scale</a></li><li><a href="global.html#seconds">seconds</a></li><li><a href="global.html#signal">signal</a></li><li><a href="global.html#source">source</a></li><li><a href="global.html#tempo">tempo</a></li><li><a href="global.html#when">when</a></li><li><a href="global.html#white">white</a></li><li><a href="global.html#withOptions">withOptions</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">envelopes.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { context } from './context'
import { isNum, toTime } from './utils'

function schedule (param, shape, times, types, ac) {
  return function (when, delay) {
    console.log(shape, times, types)
    var type
    var time = toTime(context, when, delay)
    var lt = times.length
    var tp = types.length
    shape.forEach(function (value, i) {
      time += times[i % lt]
      type = types[i % tp]
      console.log(value, time, type)
      if (type === 'set') param.setValueAtTime(value, time)
      else if (type === 'exp') param.exponentialRampToValueAtTime(value === 0 ? 0.00001 : value, time)
      else param.linearRampToValueAtTime(value, time)
    })
  }
}

export function env (shape, times, types, ac) {
  var ctx = context(ac)
  var gain = ctx.createGain()
  gain.gain.value = 0
  gain.start = schedule(gain.gain, shape, times, types, ctx)
  return gain
}

function toNum (num, def) { return isNum(num) ? num : def }
/**
 * An attack-decay-sustain-(hold)-decay envelope
 */
export function adshr (attack, decay, sustain, hold, release, ac) {
  attack = toNum(attack, 0.01)
  decay = toNum(decay, 0.1)
  sustain = toNum(sustain, 1)
  hold = toNum(hold, 0)
  release = toNum(release, 0.3)
  return env([0, 1, sustain, sustain, 0],
    [0, attack, decay, hold, release],
    ['set', 'lin', 'set', 'exp'], ac)
}

/**
 * An attack-decay envelope
 */
export function perc (attack, decay, ac) {
  return adshr(attack, 0, 1, 0, decay, ac)
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated at Fri Oct 28 2016 13:49:47 GMT+0200 (CEST)
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
